(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),l=t(66),o=t.n(l),i=(t(75),t(1)),u=t(6),s=t(3),c=t(2),h=t(4),p=(t(27),t(9)),m=t(68),f=t.n(m),v="piece";var d=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(c.a)(n).apply(this,arguments))}return Object(h.a)(n,e),Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=new Image(46,46);n.src=this.props.url,n.onload=function(){return e.props.connectDragPreview(n)}}},{key:"render",value:function(){var e=this,n=this.props.url,t=this.props,a=t.connectDragSource,l=t.isDragging;return a(r.a.createElement("div",{className:"piece_container",onClick:function(){return e.props.handle_click_start()}},r.a.createElement("img",{src:n,alt:"",className:"react_piece",style:{opacity:1,cursor:l?"grabbing":"grab"}})))}}]),n}(r.a.Component),g=Object(p.DragSource)(v,{beginDrag:function(e){return{id:e.id}},endDrag:function(e,n,t){if(n.didDrop()){var a=n.getItem();return e.handle_drag_end(a.id)}}},function(e,n){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:n.isDragging()}})(d);var b=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(c.a)(n).apply(this,arguments))}return Object(h.a)(n,e),Object(u.a)(n,[{key:"render",value:function(){var e=this,n=this.props.style,t=this.props.class_name;return(0,this.props.connectDropTarget)(r.a.createElement("div",{className:t,style:n,onClick:function(){return e.props.handle_click_end()}}," "))}}]),n}(r.a.Component),_=Object(p.DropTarget)(v,{drop:function(e){return e.handle_drop()}},function(e,n){return{connectDropTarget:e.dropTarget(),isOver:n.isOver()}})(b),k=function e(n,t,a){Object(i.a)(this,e),this.player=n,this.style={backgroundImage:"url('"+t+"')"},this.name=a,this.url=t,this.has_moved=!1},y=function(e){function n(e){var t;Object(i.a)(this,n);var a="https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg";return"black"===e&&(a="https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg"),(t=Object(s.a)(this,Object(c.a)(n).call(this,e,a,"Pawn"))).just_moved_two=!1,t}return Object(h.a)(n,e),n}(k),w=function(e){function n(e){Object(i.a)(this,n);var t="https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg";return"black"===e&&(t="https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg"),Object(s.a)(this,Object(c.a)(n).call(this,e,t,"Rook"))}return Object(h.a)(n,e),n}(k),O=function(e){function n(e){Object(i.a)(this,n);var t="https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg";return"black"===e&&(t="https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg"),Object(s.a)(this,Object(c.a)(n).call(this,e,t,"Knight"))}return Object(h.a)(n,e),n}(k),j=function(e){function n(e){Object(i.a)(this,n);var t="https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg";return"black"===e&&(t="https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg"),Object(s.a)(this,Object(c.a)(n).call(this,e,t,"Bishop"))}return Object(h.a)(n,e),n}(k),S=function(e){function n(e){Object(i.a)(this,n);var t="https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg";return"black"===e&&(t="https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg"),Object(s.a)(this,Object(c.a)(n).call(this,e,t,"Queen"))}return Object(h.a)(n,e),n}(k),E=function(e){function n(e){Object(i.a)(this,n);var t="https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg";return"black"===e&&(t="https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg"),Object(s.a)(this,Object(c.a)(n).call(this,e,t,"King"))}return Object(h.a)(n,e),n}(k),C=t(26),N=t(69),q={Pawn:1,Knight:3,Bishop:3.3,Rook:5,Queen:9.5,King:0};function K(e){if(0===e.length)return"FEN Error";for(var n,t=Array(64).fill(null),a=[0,0,0,0],r=null,l=0,o=0,i=0,u=0,s=0,c=0;l<=7&&c<e.length;){switch(u=1,e[c]){case"p":i=new y("black");break;case"r":i=new w("black");break;case"n":i=new O("black");break;case"b":i=new j("black");break;case"k":i=new E("black");break;case"q":i=new S("black");break;case"P":i=new y("white");break;case"R":i=new w("white");break;case"N":i=new O("white");break;case"B":i=new j("white");break;case"K":i=new E("white");break;case"Q":i=new S("white");break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":i=null,u=e[c].charCodeAt()-"0".charCodeAt();break;case"/":case" ":l+=1,o=0,c+=1;continue;default:return"FEN error"}for(s=0;s<u;s++)t[8*l+o]=i,o++;c++}for(n="w"===e[c]?"white":"black",c+=2,s=0;s<4&&" "!==e[c];s++){switch(e[c]){case"K":a[0]=1;break;case"Q":a[1]=1;break;case"k":a[2]=1;break;case"q":a[3]=1}c++}"-"!==e[++c]&&(o=e[c].charCodeAt()-"a".charCodeAt(),r=M(8*(7-(l=e[c+1].charCodeAt()-"1".charCodeAt()))+o));var h=function(e){for(var n=null,t=null,a=0;a<e.length;a++){var r=e[a];null!==r&&"boundary"!==r&&"King"===r.name&&("white"===r.player?n=a:t=a)}return[n,t]}(t=D(t)),p=function(e){for(var n=0,t=0;t<e.length;t++)"boundary"!==e[t]&&null!==e[t]&&("white"===e[t].player?n+=q[e[t].name]:n-=q[e[t].name]);return n}(t),m=new A(n,t,h,a,p,r);return function(e){for(var n=e.squares,t=0;t<n.length;t++)if("boundary"!==n[t]&&null!==n[t]){var a=n[t];"Pawn"===a.name&&("white"===a.player?t<81&&(a.has_moved=!0):t>38&&(a.has_moved=!0))}}(m),m}function D(e){for(var n=Array(120).fill(null),t=0,a=0,r=0;r<12;r++)for(var l=0;l<10;l++)a=10*r+l,0===l||9===l||0===r||1===r||10===r||11===r?n[a]="boundary":(n[a]=e[t],t+=1);return n}function M(e){return e+21+2*Math.floor(e/8)}function P(){return D(function(){for(var e=Array(64).fill(null),n=0;n<8;n++)e[n+8]=new y("black"),e[n+48]=new y("white");for(var t="black",a=0;a<2;a++)1===a&&(t="white"),e[56*a]=new w(t),e[56*a+7]=new w(t),e[56*a+1]=new O(t),e[56*a+6]=new O(t),e[56*a+2]=new j(t),e[56*a+5]=new j(t),e[56*a+3]=new S(t),e[56*a+4]=new E(t);return e}())}var R={Pawn:1,Knight:3,Bishop:3.3,Rook:5,Queen:9.5,King:0},Q={Pawn:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.02,.02,.02,.02,0,0,0,0,0,0,.02,.05,.05,.02,0,0,0,0,0,0,.02,.05,.05,.02,0,0,0,0,0,0,.02,.02,.02,.02,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Rook:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.01,0,.01,.02,.02,.01,0,-.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.01,0,.01,.02,.02,.01,-.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Knight:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.01,-.01,-.01,-.01,-.01,-.01,-.01,-.01,0,0,-.01,.01,.01,.01,.01,.01,.01,-.01,0,0,-.01,0,.01,.01,.01,.01,0,-.01,0,0,-.01,0,.01,.02,.02,.01,0,-.01,0,0,-.01,0,.01,.02,.02,.01,0,-.01,0,0,-.01,0,.01,.02,.02,.01,0,-.01,0,0,-.01,0,.01,.01,.01,.01,0,-.01,0,0,-.01,-.01,-.01,-.01,-.01,-.01,-.01,-.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Bishop:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Queen:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],King:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.02,.02,0,0,0,0,.02,.02,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.02,.02,0,0,0,0,.02,.02,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},B=function(){function e(n,t,a,r){Object(i.a)(this,e),this.position=n,this.history=t,this.moves=a,this.position_keys=Object(N.a)({},r,n),this.position_key=r}return Object(u.a)(e,[{key:"moves",value:function(){return T(this.position)}},{key:"make_move",value:function(e){var n=this.history.slice(),t=this.moves.slice(),a=x(this.position,e);this.position=a,this.history=n.concat(a),this.moves=t.concat(e)}},{key:"take_move",value:function(){this.history.pop(),this.moves.pop(),this.position=this.history[this.history.length-1]}}]),e}(),A=function e(n,t,a,r,l,o){Object(i.a)(this,e),this.player=n,this.squares=t,this.king_locations=a,this.castle_state=r,this.material_balance=l,this.en_passant_square=o},J=function e(n,t,a,r,l,o){Object(i.a)(this,e),this.start=n,this.end=t,this.en_passant_capture=a,this.rook_start=r,this.rook_end=l,this.promotion_piece=o};function x(e,n){var t=n.start,a=n.end,r=e.player,l=e.squares.slice(),o=JSON.parse(JSON.stringify(l[t])),i=e.king_locations.slice(),u=e.castle_state.slice(),s=e.material_balance,c=null;if(null!==n.en_passant_capture&&(l[n.en_passant_capture]=null),"Pawn"===o.name&&20===Math.abs(t-a)&&(c=t+(a-t)/2),null!==n.rook_start){var h=JSON.parse(JSON.stringify(l[n.rook_start]));l[n.rook_start]=null,l[n.rook_end]=h,h.has_moved=!0}"King"===o.name&&("white"===o.player?(i[0]=a,u[0]=0,u[1]=0):(i[1]=a,u[2]=0,u[3]=0)),"Rook"!==o.name||o.has_moved||(98===t?u[0]=0:91===t?u[1]=0:28===t?u[2]=0:21===t&&(u[3]=0)),null!==l[a]&&"Rook"===l[a].name&&(98===a?u[0]=0:91===a?u[1]=0:28===a?u[2]=0:21===a&&(u[3]=0)),null!==s&&null!==l[a]&&("white"===e.player?s+=R[l[a].name]:s-=R[l[a].name]),null!==n.promotion_piece&&(s="white"===(o=n.promotion_piece).player?s+R[o.name]-1:s-R[o.name]+1);var p=Q[o.name][a]-Q[o.name][t];return"white"===o.player?s+=p:s-=p,l[t]=null,l[a]=o,o.has_moved=!0,new A(r="white"===r?"black":"white",l,i,u,s,c)}function F(){var e=new A("white",P(),[95,25],[1,1,1,1],0);return new B(e,[e],[])}function T(e){var n=e.squares,t=e.player,a="white"===t?e.king_locations[0]:e.king_locations[1],r=V(n,a,t),l=null,o=e.castle_state,i=e.en_passant_square;null!==i&&(l=function(e,n,t,a){var r=ie(1,n),l=e.slice();return l[r]=null,V(l,t,a)}(n,i,a,t));var u=function(e,n,t){for(var a=[],r=[],l=ce(1,ie(1,n,t),t),o=se(1,ie(1,n,t),t),i=[l,o],u=ee(n,t),s=[[1,1],[-1,1],[1,-1],[-1,-1]],c=[[0,1],[0,-1],[-1,0],[1,0]],h=0;h<s.length;h++){var p=L(e,s[h],n,t,["Queen","Bishop"]),m=Object(C.a)(p,2),f=m[0],v=m[1];null!==v&&(r=r.concat(f),a.push(v))}for(h=0;h<c.length;h++){var d=L(e,c[h],n,t,["Queen","Rook"]),g=Object(C.a)(d,2),f=g[0],v=g[1];null!==v&&(r=r.concat(f),a.push(v))}for(h=0;h<u.length;h++){var b=e[u[h]];"boundary"!==b&&null!==b&&b.player!==t&&"Knight"===b.name&&(r=r.concat([u[h]]),a.push(b))}for(h=0;h<i.length;h++){var _=e[i[h]];"boundary"!==_&&null!==_&&_.player!==t&&"Pawn"===_.name&&(r=r.concat([i[h]]),a.push(_))}return[a,r]}(n,a,t),s=Object(C.a)(u,2),c=s[0],h=s[1],p=c.length>0;if(c.length>1)return z(n,a,t,o,p);for(var m=[],f=0;f<120;f++)null!==n[f]&&"boundary"!==n[f]&&n[f].player===t&&("Pawn"===n[f].name?m=m.concat(I(n,f,t,r,i,l)):"Knight"===n[f].name?m=m.concat(G(n,f,t,r)):"Bishop"===n[f].name?m=m.concat(W(n,f,t,r)):"Rook"===n[f].name?m=m.concat($(n,f,t,r)):"Queen"===n[f].name?m=(m=m.concat($(n,f,t,r))).concat(W(n,f,t,r)):"King"===n[f].name&&(m=m.concat(z(n,f,t,o,p))));return c.length>0&&(m=function(e,n,t){for(var a=e.length-1;a>=0;a--){var r=e[a];t.includes(r.end)||t.includes(r.en_passant_capture)||r.start===n||e.splice(a,1)}return e}(m,a,h)),m}function I(e,n,t,a,r,l){var o=[],i=e[n],u=ie(1,n,t),s=ie(2,n,t),c=se(1,n,t),h=ce(1,n,t),p=se(1,ie(1,n,t),t),m=ce(1,ie(1,n,t),t);return i.has_moved||null!==e[s]||null!==e[u]||(o=o.concat(Y(i,n,s,a,[0,1],!1,null,null))),null===e[u]&&(o=o.concat(Y(i,n,u,a,[0,1],!1,null,null))),null!==e[p]&&"boundary"!==e[p]&&e[p].player!==t&&(o=o.concat(Y(i,n,p,a,[-1,1],!1,null,null))),null!==e[m]&&"boundary"!==e[m]&&e[m].player!==t&&(o=o.concat(Y(i,n,m,a,[1,1],!1,null,null))),m===r&&(o=o.concat(Y(i,n,m,a,[1,1],!0,h,l))),p===r&&(o=o.concat(Y(i,n,p,a,[-1,1],!0,c,l))),o}function G(e,n,t,a){var r=[];if(n in a)return r;for(var l=ee(n,t),o=0;o<l.length;o++)null===e[l[o]]&&"boundary"!==e[l[o]]?r.push(te(n,l[o])):e[l[o]].player!==t&&"boundary"!==e[l[o]]&&r.push(te(n,l[o]));return r}function W(e,n,t,a){for(var r=[],l=e[n],o=null,i=null,u=[[1,1],[-1,1],[1,-1],[-1,-1]],s=0;s<u.length;s++)n in a?(i=[-1*(o=a[n])[0],-1*o[1]],u[s].toString()!==o.toString()&&u[s].toString()!==i.toString()||(r=r.concat(Z(e,u[s],n,t,l)))):r=r.concat(Z(e,u[s],n,t,l));return r}function $(e,n,t,a){for(var r=[],l=e[n],o=null,i=null,u=[[0,1],[0,-1],[-1,0],[1,0]],s=0;s<u.length;s++)n in a?(i=[-1*(o=a[n])[0],-1*o[1]],u[s].toString()!==o.toString()&&u[s].toString()!==i.toString()||(r=r.concat(Z(e,u[s],n,t,l)))):r=r.concat(Z(e,u[s],n,t,l));return r}function z(e,n,t,a,r){var l=[],o=e.slice();o[n]=null;for(var i=ne(n,t),u=0;u<i.length;u++)null===e[i[u]]?U(o,i[u],t)[0]||l.push(te(n,i[u])):"boundary"===e[i[u]]||e[i[u]].player===t||U(o,i[u],t)[0]||l.push(te(n,i[u]));return r||(1===a[0]&&null===e[96]&&null===e[97]&&(U(e,96,t)[0]||U(e,97,t)[0]||l.push(re(95,97,98,96))),1===a[1]&&null===e[94]&&null===e[93]&&null===e[92]&&(U(e,94,t)[0]||U(e,93,t)[0]||l.push(re(95,93,91,94))),1===a[2]&&null===e[26]&&null===e[27]&&(U(e,26,t)[0]||U(e,27,t)[0]||l.push(re(25,27,28,26))),1===a[3]&&null===e[24]&&null===e[23]&&null===e[22]&&(U(e,24,t)[0]||U(e,23,t)[0]||l.push(re(25,23,21,24)))),l}function H(e,n,t,a,r){for(var l=oe(n,t,a),o=null;null===e[l];)l=oe(n,l,a);var i=e[l];if("boundary"!==i&&i.player!==a)for(var u=0;u<r.length;u++)r[u]===i.name&&(o=[l,n]);return o}function L(e,n,t,a,r){for(var l=oe(n,t,a),o=[l];null===e[l];)l=oe(n,l,a),o.push(l);var i=e[l];if("boundary"!==i&&i.player!==a)for(var u=0;u<r.length;u++)if(r[u]===i.name)return o.push(l),[o,i];return[null,null]}function U(e,n,t){for(var a=!1,r={},l=null,o=[ce(1,ie(1,n,t),t),se(1,ie(1,n,t),t)],i=ee(n,t),u=ne(n,t),s=[[1,1],[-1,1],[1,-1],[-1,-1]],c=[[0,1],[0,-1],[-1,0],[1,0]],h=0;h<s.length;h++)null!==(l=H(e,s[h],n,t,["Queen","Bishop"]))&&(a=!0,r[l[0]]=l[1]);for(h=0;h<c.length;h++)null!==(l=H(e,c[h],n,t,["Queen","Rook"]))&&(a=!0,r[l[0]]=l[1]);for(h=0;h<i.length;h++){var p=e[i[h]];"boundary"!==p&&null!==p&&p.player!==t&&"Knight"===p.name&&(a=!0,r[i[h]]="knight_attack")}for(h=0;h<o.length;h++){var m=e[o[h]];"boundary"!==m&&null!==m&&m.player!==t&&"Pawn"===m.name&&(a=!0,r[o[h]]="pawn_attack")}for(h=0;h<u.length;h++){var f=e[u[h]];"boundary"!==f&&null!==f&&f.player!==t&&"King"===f.name&&(a=!0)}return[a,r]}function V(e,n,t){for(var a={},r=null,l=[[0,1],[0,-1],[-1,0],[1,0],[1,1],[-1,1],[1,-1],[-1,-1]],o=null,i=0;i<l.length;i++)null!==(r=0===(o=l[i])[0]||0===o[1]?X(e,o,n,t,["Queen","Rook"]):X(e,o,n,t,["Queen","Bishop"]))&&(a[r[0]]=r[1]);return a}function X(e,n,t,a,r){for(var l=oe(n,t,a),o=null;null===e[l];)l=oe(n,l,a);if("boundary"!==e[l]&&e[l].player===a){for(o=l,l=oe(n,l,a);null===e[l];)l=oe(n,l,a);if("boundary"!==e[l]&&e[l].player!==a)for(var i=0;i<r.length;i++)if(e[l].name===r[i])return[o,n]}return null}function Y(e,n,t,a,r,l,o,i){var u=[],s=null,c=null;if(n in a)c=[-1*(s=a[n])[0],-1*s[1]],r.toString()!==s.toString()&&r.toString()!==c.toString()||(l?u.push(le(n,t,o)):u.push(te(n,t)));else if(l)n in i?(c=[-1*(s=i[n])[0],-1*s[1]],r.toString()!==s.toString()&&r.toString()!==c.toString()||u.push(le(n,t,o))):u.push(le(n,t,o));else if(t>=91||t<=28)for(var h=[new O(e.player),new j(e.player),new w(e.player),new S(e.player)],p=0;p<h.length;p++)u.push(ae(h[p],n,t));else u.push(te(n,t));return u}function Z(e,n,t,a,r){for(var l=[],o=oe(n,t,a);null===e[o];)l.push(te(t,o)),o=oe(n,o,a);return"boundary"!==e[o]&&e[o].player!==a&&l.push(te(t,o)),l}function ee(e,n){return[ce(1,ie(2,e,n),n),se(1,ie(2,e,n),n),ce(1,ue(2,e,n),n),se(1,ue(2,e,n),n),ce(2,ie(1,e,n),n),ce(2,ue(1,e,n),n),se(2,ie(1,e,n),n),se(2,ue(1,e,n),n)]}function ne(e,n){return[ie(1,e,n),ce(1,ie(1,e,n),n),se(1,ie(1,e,n),n),se(1,e,n),ce(1,e,n),ce(1,ue(1,e,n),n),se(1,ue(1,e,n),n),ue(1,e,n)]}function te(e,n){return new J(e,n,null,null,null,null)}function ae(e,n,t){return new J(n,t,null,null,null,e)}function re(e,n,t,a){return new J(e,n,null,t,a,null)}function le(e,n,t){return new J(e,n,t,null,null,null)}function oe(e,n,t){var a=e[0],r=e[1],l=ce(1,ie(1,n,t),t),o=se(1,ie(1,n,t),t),i=ce(1,ue(1,n,t),t),u=se(1,ue(1,n,t),t),s=ie(1,n,t),c=ue(1,n,t),h=ce(1,n,t),p=se(1,n,t);return 0===a&&1===r?s:-1===a&&1===r?o:1===a&&1===r?l:1===a&&0===r?h:-1===a&&0===r?p:1===a&&-1===r?i:-1===a&&-1===r?u:0===a&&-1===r?c:void 0}function ie(e,n,t){return"white"===t?n-10*e:n+10*e}function ue(e,n,t){return"white"===t?n+10*e:n-10*e}function se(e,n,t){return"white"===t?n-e:n+e}function ce(e,n,t){return"white"===t?n+e:n-e}var he=1e4,pe=9e3,me=null,fe=null,ve=null,de=!1,ge=null;function be(e){me=performance.now(),fe=e,ve=0,de=!1,ge=0}function _e(e,n,t,a){if(0===n)return{value:ke(e),move:null};var r=T(e);if(ge+=r.length,0===r.length)return"white"===e.player?{value:-pe,move:null}:{value:pe,move:null};if(de)return{value:0,move:null};if("white"===e.player){for(var l=-he,o=null,i=0;i<r.length;i++){var u=r[i],s=x(e,u);if((l=Math.max(l,_e(s,n-1,t,a).value))>t&&(t=l,o=u),t>=a)break}return performance.now()-me>=fe?(de=!0,{value:0,move:null}):{value:l,move:o}}for(var c=he,h=null,p=0;p<r.length;p++){var m=r[p],f=x(e,m);if((c=Math.min(c,_e(f,n-1,t,a).value))<a&&(a=c,h=m),t>=a)break}return performance.now()-me>=fe?(de=!0,{value:0,move:null}):{value:c,move:h}}function ke(e){return e.material_balance}var ye=1e4,we=9e3,Oe={Pawn:0,Knight:0,Bishop:0,Rook:0,Queen:0,King:0},je=null,Se=1;function Ee(){var e={},n=0;for(var t in Oe)e[t]=Oe[t]+(Math.random()-.5)*Se,Math.abs(e[t])>n&&(n=Math.abs(e[t]));for(t in e)e[t]=e[t]/n;je=e}function Ce(e){for(var n=null,t=0,a=0;e.history.length<100;){t=(n="white"===e.position.player?Ne(e.position,1,-ye,ye,"base"):Ne(e.position,1,-ye,ye,"genetic")).value;var r=n.move;if(!(Math.abs(t)<1e3))break;e.make_move(r)}return 9e3===t?a=-1:-9e3===t&&(a=1),{result:a,weights:je}}function Ne(e,n,t,a,r){if(0===n)return"genetic"===r?{value:function(e){for(var n=e.squares,t=0,a=0;a<n.length;a++)if("boundary"!==n[a]&&null!==n[a]){var r=n[a];"white"===r.player?t+=je[r.name]:t-=je[r.name]}return t}(e),move:null}:{value:function(e){for(var n=e.squares,t=0,a=0;a<n.length;a++)if("boundary"!==n[a]&&null!==n[a]){var r=n[a];"white"===r.player?t+=Oe[r.name]:t-=Oe[r.name]}return t}(e),move:null};var l=T(e);if(0===l.length){var o=!1;return o?"white"===e.player?(o=U(e.squares,e.king_locations[0],e.player)[0],{value:-we,move:null}):(o=U(e.squares,e.king_locations[1],e.player)[0],{value:we,move:null}):{value:0,move:null}}if("white"===e.player){for(var i=-ye,u=null,s=0;s<l.length;s++){var c=l[s],h=x(e,c);if((i=Math.max(i,Ne(h,n-1,t,a,r).value))>t&&(t=i,u=c),t>=a)break}return{value:i,move:u}}for(var p=ye,m=null,f=0;f<l.length;f++){var v=l[f],d=x(e,v);if((p=Math.min(p,Ne(d,n-1,t,a,r).value))<a&&(a=p,m=v),t>=a)break}return{value:p,move:m}}var qe=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(c.a)(n).call(this,e))).state={game:F(),drag_end:null,promotion:{class:"hidden",start:null,end:null,player:null},status:null,click_start:null},t}return Object(h.a)(n,e),Object(u.a)(n,[{key:"train",value:function(){this.state.game;!function(){var e=new A("white",P(),[95,25],[1,1,1,1],0);Ee();var n=0;Se=1;for(var t=0;t<50;t++){var a=new B(e,[e],[]),r=T(a.position),l=r[Math.floor(Math.random()*r.length)];a.make_move(l),l=(r=T(a.position))[Math.floor(Math.random()*r.length)],a.make_move(l),n+=Ce(a).result}console.log(n,Oe,je),n>3&&(Se/=2,Oe=je,Ee())}()}},{key:"reset",value:function(){this.setState({game:F(),drag_end:null,promotion:{class:"hidden",start:null,end:null,player:null},status:null})}},{key:"back",value:function(){var e=this.state.game;e.history.length<=1||(e.take_move(),this.setState({game:e,status:null}))}},{key:"setup_fen",value:function(e){var n=K(e);if("FEN Error"!==n){var t=new B(n,[],[]);this.setState({game:t,drag_end:null,promotion:{class:"hidden",start:null,end:null,player:null},status:null})}else alert("FEN ERROR")}},{key:"engine_move",value:function(){var e=this.state.game,n=function(e,n,t){be(t);for(var a={value:0,move:null},r=1;r<=n;r++){var l=_e(e,r,-he,he);null!==l.move&&(a=l,ve=r)}return console.log("depth searched:",ve,"total positions:",ge),a}(e.position,10,1e3);null!==n.move?(e.make_move(n.move),this.setState({game:e})):this.setState({status:"Game Over"})}},{key:"handle_drop",value:function(e){this.setState({drag_end:e})}},{key:"handle_click_start",value:function(e){var n=M(e);this.setState({click_start:n})}},{key:"handle_click_end",value:function(e){var n=this.state.game,t=n.position,a=this.state.click_start,r=t.squares[a],l=M(e);if((l<=28||l>=91)&&"Pawn"===r.name){var o={class:"promotion_container",start:a,end:l,player:t.player};this.setState({promotion:o})}else this.change_states(n,a,l,null)}},{key:"handle_drag_end",value:function(e){var n=this.state.game,t=n.position,a=M(e),r=M(this.state.drag_end),l=t.squares[a];if((r<=28||r>=91)&&"Pawn"===l.name){var o={class:"promotion_container",start:a,end:r,player:t.player};this.setState({promotion:o})}else this.change_states(n,a,r,null)}},{key:"handle_promotion",value:function(e){var n=this.state.game,t=this.state.promotion,a=t.start,r=t.end;this.change_states(n,a,r,e),this.setState({promotion:{class:"hidden",start:null,end:null,player:null}})}},{key:"change_states",value:function(e,n,t,a){var r=this,l=T(e.position),o=function(e,n,t,a){var r=t.squares,l=t.squares[e],o=null,i=null,u=null;return"Pawn"===l.name&&(9===Math.abs(e-n)&&null===r[n]?o="white"===t.player?e+1:e-1:11===Math.abs(e-n)&&null===r[n]&&(o="white"===t.player?e-1:e+1)),"King"===l.name&&(n-e===2?(i=n+1,u=e+1):e-n===2&&(i=n-2,u=e-1)),new J(e,n,o,i,u,a)}(n,t,e.position,a),i=null;(function(e,n){for(var t=!1,a=0;a<n.length;a++)JSON.stringify(e)===JSON.stringify(n[a])&&(t=!0);return t})(o,l)&&(e.make_move(o),0===T(e.position).length&&(i="Game Over"),setTimeout(function(){r.setState({game:e,drag_end:null,status:i})},10),"black"===e.position.player&&setTimeout(this.engine_move.bind(this),50))}},{key:"render",value:function(){var e=this,n=this.state.game.position,t=function(e){for(var n=Array(64).fill(null),t=0,a=0,r=0;r<12;r++)for(var l=0;l<10;l++)a=10*r+l,0===l||9===l||0===r||1===r||10===r||11===r||(n[t]=e[a],t+=1);return n}(n.squares),a=n.player,l=this.state.promotion.class;return r.a.createElement("div",{className:"game_container"},r.a.createElement(Me,{back:function(){return e.back()},reset:function(){return e.reset()},engine_move:function(){return e.engine_move()},train:function(){return e.train()}}),r.a.createElement("div",{className:"board_container"},r.a.createElement(Ke,{squares:t,onDrop:function(n){return e.drop(n)},player:a,handle_drop:function(n){return e.handle_drop(n)},handle_drag_end:function(n){return e.handle_drag_end(n)},handle_click_start:function(n){return e.handle_click_start(n)},handle_click_end:function(n){return e.handle_click_end(n)}})),r.a.createElement(Pe,{setup_fen:function(n){return e.setup_fen(n)}}),r.a.createElement(Re,{className:l,player:a,handle_promotion:function(n){return e.handle_promotion(n)}}))}}]),n}(a.Component),Ke=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(c.a)(n).apply(this,arguments))}return Object(h.a)(n,e),Object(u.a)(n,[{key:"renderSquares",value:function(){for(var e=this,n=[],t=!1,a=0;a<8;a++){t=!t;for(var l=[],o=function(){var n=8*a+i,o=r.a.createElement(De,{value:e.props.squares[n],key:n,color:t,player:e.props.player,id:n,handle_drop:function(){return e.props.handle_drop(n)},handle_drag_end:function(n){return e.props.handle_drag_end(n)},handle_click_start:function(){return e.props.handle_click_start(n)},handle_click_end:function(){return e.props.handle_click_end(n)}});l.push(o),t=!t},i=0;i<8;i++)o();l=r.a.createElement("div",{className:"board_row",key:a}," ",l," "),n.push(l)}return n}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderSquares())}}]),n}(r.a.Component),De=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(c.a)(n).apply(this,arguments))}return Object(h.a)(n,e),Object(u.a)(n,[{key:"renderSquare",value:function(e){var n=this,t="dark square",a=null,l=null,o=null;return e&&(t="light square"),this.props.value&&(a=this.props.value.style,l=this.props.value.url,o=this.props.value.player),this.props.player===o?r.a.createElement("div",{className:t},r.a.createElement(g,{url:l,id:this.props.id,handle_drag_end:function(e){return n.props.handle_drag_end(e)},handle_click_start:function(){return n.props.handle_click_start()}})):r.a.createElement(_,{class_name:t,style:a,handle_drop:function(){return n.props.handle_drop()},handle_click_end:function(){return n.props.handle_click_end()}})}},{key:"render",value:function(){var e=this.props.color;return r.a.createElement(r.a.Fragment,null,this.renderSquare(e))}}]),n}(r.a.Component);function Me(e){return r.a.createElement("div",{className:"button_container"},r.a.createElement("button",{className:"button_element",onClick:function(){return e.reset()}}," Reset"),r.a.createElement("button",{className:"button_element",onClick:function(){return e.back()}}," Back"),r.a.createElement("button",{className:"button_element",onClick:function(){return e.engine_move()}}," Engine Move"))}var Pe=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(c.a)(n).call(this,e))).state={value:""},t}return Object(h.a)(n,e),Object(u.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"submit",value:function(e){e.preventDefault(),this.props.setup_fen(this.state.value)}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{onSubmit:function(n){return e.submit(n)},className:"fen_input"},r.a.createElement("label",null,"FEN String: \xa0",r.a.createElement("input",{type:"text",className:"input_box",value:this.state.value,onChange:function(n){return e.handleChange(n)}})),r.a.createElement("input",{type:"submit",className:"input_button",value:"Set Position"}))}}]),n}(r.a.Component),Re=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(c.a)(n).apply(this,arguments))}return Object(h.a)(n,e),Object(u.a)(n,[{key:"render",value:function(){var e=this,n=new O(this.props.player),t=new j(this.props.player),a=new w(this.props.player),l=new S(this.props.player);return r.a.createElement("div",{className:this.props.className},r.a.createElement("div",{className:"promotion"},r.a.createElement("button",{className:"promotion_button",style:n.style,onClick:function(){return e.props.handle_promotion(n)}}),r.a.createElement("button",{className:"promotion_button",style:t.style,onClick:function(){return e.props.handle_promotion(t)}}),r.a.createElement("button",{className:"promotion_button",style:a.style,onClick:function(){return e.props.handle_promotion(a)}}),r.a.createElement("button",{className:"promotion_button",style:l.style,onClick:function(){return e.props.handle_promotion(l)}})))}}]),n}(r.a.Component),Qe=Object(p.DragDropContext)(f.a)(qe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},27:function(e,n,t){},70:function(e,n,t){e.exports=t(194)},75:function(e,n,t){}},[[70,2,1]]]);
//# sourceMappingURL=main.ccb9a5e0.chunk.js.map